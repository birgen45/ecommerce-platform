<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>birgenshop </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #878181;
        }

        /* Header Styles */
        .top-bar {
            background: #ff6900;
            color: white;
            padding: 8px 0;
            font-size: 13px;
        }

        .top-bar .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .top-bar a {
            color: white;
            text-decoration: none;
            margin-right: 20px;
        }

        .main-header {
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 15px 0;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #ff6900;
        }

        .search-container {
            flex: 1;
            position: relative;
            max-width: 500px;
        }

        .search-bar {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #ff6900;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
        }

        .search-btn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: #ff6900;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
        }

        .header-actions {
            display: flex;
            gap: 25px;
            align-items: center;
        }

        .header-link {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #333;
            text-decoration: none;
            font-size: 14px;
            position: relative;
        }

        .cart-container {
            position: relative;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff6900;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transform: scale(0);
            transition: transform 0.3s ease;
            z-index: 10;
        }

        .cart-badge.show {
            transform: scale(1);
        }

        .cart-badge.animate {
            animation: bounce 0.6s ease-in-out;
        }

        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: scale(1);
            }
            40%, 43% {
                transform: scale(1.3);
            }
            70% {
                transform: scale(1.1);
            }
            90% {
                transform: scale(1.05);
            }
        }

        /* Navigation Menu */
        .nav-menu {
            background: white;
            border-top: 1px solid #eee;
            padding: 0;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .nav-list {
            display: flex;
            list-style: none;
            gap: 30px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .nav-list::-webkit-scrollbar {
            display: none;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            display: block;
            padding: 15px 0;
            color: #333;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
            white-space: nowrap;
        }

        .nav-link:hover {
            color: #ff6900;
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg,  #98470d, #ff8533);
            color: white;
            padding: 60px 0;
            margin: 20px 0;
            border-radius: 12px;
            text-align: center;
        }

        .hero-content h1 {
            font-size: 48px;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .hero-content p {
            font-size: 18px;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .cta-button {
            background: white;
            color: #ff6900;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .cta-button:hover {
            transform: translateY(-2px);
        }

        /* Categories Section */
        .categories-section {
            margin: 40px 0;
        }

        .section-title {
            font-size: 28px;
            margin-bottom: 30px;
            color: #333;
            text-align: center;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 50px;
        }

        .category-card {
            background: white;
            border-radius: 12px;
            padding: 30px 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            cursor: pointer;
        }

        .category-card:hover {
            transform: translateY(-5px);
        }

        .category-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: #ff6900;
        }

        .category-name {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        /* Products Grid */
        .products-section {
            margin: 50px 0;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
        }

        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-5px);

        }
        .product-card.highlight {
            border: 3px solid #ff6900;
            box-shadow: 0 8px 20px rgba(255, 105, 0, 0.3);
            transform: translateY(-5px);
        }

        .product-image {
            width: 100%;
            height: 200px;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .product-image:hover img {
            transform: scale(1.05);
        }

        .product-image .placeholder {
            font-size: 48px;
            color: #ccc;
            text-align: center;
        }

        .product-info {
            padding: 20px;
        }

        .product-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .product-price {
            font-size: 20px;
            font-weight: 700;
            color: #ff6900;
            margin-bottom: 10px;
        }

        .old-price {
            text-decoration: line-through;
            color: #999;
            font-size: 14px;
            margin-left: 8px;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 15px;
        }

        .stars {
            color: #ffd700;
        }

        .rating-count {
            color: #666;
            font-size: 13px;
        }

        .add-to-cart {
            width: 100%;
            background: #ff6900;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .add-to-cart:hover {
            background: #e55a00;
            transform: translateY(-2px);
        }

        .add-to-cart:active {
            transform: translateY(0);
        }

        /* Success Notification */
        .cart-success {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
            font-weight: 500;
        }

        .cart-success.show {
            transform: translateX(0);
        }.cart-dropdown {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -2px 0 15px rgba(0,0,0,0.2);
            z-index: 1001;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .cart-dropdown.open {
            right: 0;
        }

        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .cart-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        .cart-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
        }

        .cart-header h3 {
            margin: 0;
            color: #333;
            font-size: 18px;
        }

        .close-cart {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s;
        }

        .close-cart:hover {
            background: #f0f0f0;
        }

        .cart-items {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .empty-cart {
            text-align: center;
            color: #666;
            margin-top: 50px;
        }

        .empty-cart p {
            margin-bottom: 10px;
            font-size: 16px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-image {
            width: 60px;
            height: 60px;
            background: #f0f0f0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .cart-item-details {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 14px;
            line-height: 1.3;
        }

        .cart-item-price {
            color: #ff6900;
            font-weight: 700;
            font-size: 16px;
        }

        .cart-item-actions {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .remove-item {
            background: #ff4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .remove-item:hover {
            background: #cc3333;
        }

        .cart-footer {
            padding: 20px;
            border-top: 1px solid #eee;
            background: #f8f9fa;
        }

        .cart-total {
            margin-bottom: 15px;
            font-size: 18px;
            text-align: center;
        }

        .cart-actions {
            display: flex;
            gap: 10px;
        }

        .clear-cart-btn {
            flex: 1;
            background: #666;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .clear-cart-btn:hover {
            background: #555;
        }

        .checkout-btn {
            flex: 2;
            background: #ff6900;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .checkout-btn:hover {
            background: #e55a00;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }

            .search-container {
                max-width: 100%;
                order: 2;
            }

            .header-actions {
                order: 1;
                width: 100%;
                justify-content: space-between;
            }

            .nav-list {
                gap: 15px;
                padding-bottom: 10px;
            }

            .hero-content h1 {
                font-size: 32px;
            }

            .hero-content p {
                font-size: 16px;
            }

            .categories-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }

            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }

            .cart-success {
                top: 10px;
                right: 10px;
                left: 10px;
                transform: translateY(-100px);
            }

            .cart-success.show {
                transform: translateY(0);
            }
        }

        @media (max-width: 480px) {
            .header-content {
                padding: 0 10px;
            }

            .container {
                padding: 0 10px;
            }

            .hero-content h1 {
                font-size: 28px;
            }

            .section-title {
                font-size: 24px;
            }

            .products-grid {
                grid-template-columns: 1fr;
            }

            .nav-list {
                gap: 10px;
            }

            .header-actions {
                gap: 15px;
            }

            .cart-badge {
                width: 18px;
                height: 18px;
                font-size: 10px;
            }
            .nav-link.active {
    color: #ff6900;
    position: relative;
}

.nav-link.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: #ff6900;
}

.products-grid .product-card.hidden {
    display: none;
}

.no-products {
    text-align: center;
    color: #666;
    font-size: 18px;
    margin: 50px 0;
    grid-column: 1 / -1;
}
/* Delivery Modal */
.delivery-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 2500;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.delivery-modal.open {
    opacity: 1;
    visibility: visible;
}

.delivery-modal-content {
    background: white;
    border-radius: 16px;
    max-width: 700px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    transform: scale(0.8);
    transition: transform 0.3s ease;
}

.delivery-modal.open .delivery-modal-content {
    transform: scale(1);
}

.modal-header {
    padding: 20px 25px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #f8f9fa;
    border-radius: 16px 16px 0 0;
}

.close-modal {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #666;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.modal-body {
    padding: 25px;
}

/* Order Summary */
.order-summary {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 25px;
}

.order-summary h3 {
    margin-bottom: 15px;
    color: #333;
}

.checkout-item {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    border-bottom: 1px solid #eee;
}

.order-total {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 2px solid #ddd;
    font-size: 18px;
    color: #ff6900;
}

/* Delivery Options */
.delivery-options-section h3 {
    margin-bottom: 20px;
    color: #333;
}

.delivery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 15px;
    margin-bottom: 25px;
}

.delivery-option {
    background: #f8f9fa;
    padding: 20px 15px;
    border-radius: 8px;
    text-align: center;
    border: 2px solid transparent;
    cursor: pointer;
    transition: all 0.3s ease;
}

.delivery-option:hover {
    border-color: #ff6900;
    background: white;
}

.delivery-option.selected {
    border-color: #ff6900;
    background: #fff5f0;
}

.delivery-option.disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.delivery-icon {
    font-size: 32px;
    margin-bottom: 8px;
}

.delivery-option h4 {
    font-size: 16px;
    margin-bottom: 5px;
    color: #333;
}

.delivery-option p {
    color: #666;
    font-size: 12px;
    margin-bottom: 8px;
}

.delivery-price {
    font-weight: 700;
    color: #ff6900;
    font-size: 14px;
}

/* Final Total */
.final-total {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    border: 2px solid #ff6900;
}

.total-breakdown {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.total-line {
    display: flex;
    justify-content: space-between;
    font-size: 16px;
}

.total-line.final {
    border-top: 1px solid #ddd;
    padding-top: 10px;
    font-size: 18px;
    color: #ff6900;
}

/* Modal Actions */
.modal-actions {
    padding: 20px 25px;
    border-top: 1px solid #eee;
    display: flex;
    gap: 15px;
    justify-content: flex-end;
}

.btn-secondary {
    background: #6c757d;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
}

.btn-primary {
    background: #ff6900;
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
}

.btn-primary:disabled {
    background: #ccc;
    cursor: not-allowed;
}
/* Footer Styles */
.footer {
    background: linear-gradient(135deg, #2d5a4a, #1a4238);
    color: white;
    position: relative;
    overflow: hidden;
    margin-top: 50px;
}

/* Curved top border */
.footer::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 60px;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 120'%3E%3Cpath fill='%23878181' d='M0,0 C480,120 960,120 1440,0 L1440,120 L0,120 Z'/%3E%3C/svg%3E") no-repeat;
    background-size: cover;
    background-position: bottom;
}

.footer {
    background: linear-gradient(135deg, #2d5a4a, #1a4238) !important;
    color: white !important;
    position: relative !important;
    overflow: hidden !important;
    margin-top: 50px !important;
}

.footer-content {
    position: relative !important;
    z-index: 1 !important;
    max-width: 1200px !important;
    margin: 0 auto !important;
    padding: 80px 20px 40px !important;
}

.footer-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 40px;
    margin-bottom: 50px;
}

.footer-section h3 {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 25px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: white;
}

.footer-links {
    list-style: none;
}

.footer-links li {
    margin-bottom: 12px;
}

.footer-links a {
    color: #b8d4c8;
    text-decoration: none;
    font-size: 16px;
    transition: all 0.3s ease;
    display: block;
    padding: 2px 0;
}

.footer-links a:hover {
    color: #ff6900;
    transform: translateX(5px);
}

/* Newsletter Section */
.newsletter-section {
    grid-column: span 2;
}

.newsletter-section h3 {
    font-size: 22px;
    margin-bottom: 15px;
    color: white;
}

.newsletter-description {
    color: #b8d4c8;
    margin-bottom: 25px;
    font-size: 16px;
    line-height: 1.5;
}

.newsletter-form {
    display: flex;
    gap: 10px;
    margin-bottom: 25px;
    flex-wrap: wrap;
}

.newsletter-input {
    flex: 1;
    min-width: 250px;
    padding: 15px 20px;
    border: none;
    border-radius: 50px;
    font-size: 16px;
    outline: none;
    background: white;
    color: #333;
}

.newsletter-input::placeholder {
    color: #999;
}

.newsletter-btn {
    background: #ff6900;
    color: white;
    border: none;
    padding: 15px 30px;
    border-radius: 50px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
}

.newsletter-btn:hover {
    background: #e55a00;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255, 105, 0, 0.3);
}

/* Social Media Icons */
.social-links {
    display: flex;
    gap: 20px;
    margin-top: 20px;
}

.social-link {
    width: 45px;
    height: 45px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #b8d4c8;
    font-size: 20px;
    text-decoration: none;
    transition: all 0.3s ease;
    border: 2px solid transparent;
}

.social-link:hover {
    background: #ff6900;
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(255, 105, 0, 0.3);
}

/* Footer Bottom */
.footer-bottom {
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    padding-top: 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 20px;
}

.copyright {
    color: #b8d4c8;
    font-size: 16px;
}

.footer-bottom-links {
    display: flex;
    gap: 30px;
    flex-wrap: wrap;
}

.footer-bottom-links a {
    color: #b8d4c8;
    text-decoration: none;
    font-size: 16px;
    transition: color 0.3s ease;
}

.footer-bottom-links a:hover {
    color: #ff6900;
}

/* Success Message */
.newsletter-success {
    background: #4CAF50;
    color: white;
    padding: 10px 20px;
    border-radius: 25px;
    margin-top: 10px;
    display: none;
    animation: slideIn 0.3s ease;
}

.newsletter-success.show {
    display: block;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Footer Responsive Design */
@media (max-width: 768px) {
    .footer-grid {
        grid-template-columns: 1fr;
        gap: 30px;
    }

    .newsletter-section {
        grid-column: span 1;
    }

    .newsletter-form {
        flex-direction: column;
        align-items: stretch;
    }

    .newsletter-input {
        min-width: auto;
        margin-bottom: 10px;
    }

    .footer-bottom {
        flex-direction: column;
        text-align: center;
    }

    .footer-bottom-links {
        justify-content: center;
        gap: 20px;
    }

    .social-links {
        justify-content: center;
    }
}
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="container">
        
            
        </div>
    </div>

    <header class="main-header">
        <div class="header-content">
            <div class="logo">Shop</div>
    <div class="search-container">
      <input type="text" class="search-bar" placeholder="Search products..." id="searchInput" onkeyup="handleSearch(event)">
      <buttonclass="search-btn" onclick="performSearch()"></button>
    </div>
            <div class="header-actions">
                <a href="#" class="header-link"onclick="toggleAcount(event)">
                    
                    <span class="Account" id="Account"></span> 
                </a>
                
                <a href="#" class="header-link"onclick="toggleCart(event)">
                    <div class="cart-container">
                        🛒 Cart
                        <span class="cart-badge" id="cartBadge">0</span>
                    </div>
                </a>
            </div>
        </div>
    </header>

    <nav class="nav-menu">
    <div class="nav-container">
        <ul class="nav-list">
            
            <li class="nav-item"><a href="#" class="nav-link" onclick="filterByCategory('Electronics')">Electronics</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="filterByCategory('Fashion')">Fashion</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="filterByCategory('Home & Garden')">Home</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="filterByCategory('Sports')">Sports</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="filterByCategory('Gaming')">Gaming</a></li>
            <li class="nav-item"><a href="#" class="nav-link" onclick="filterByCategory('Books')">Books</a></li>

            <li class="nav-item"><a href="#" class="nav-link active" onclick="showAllProducts()">All Products</a></li>
        
        </ul>
    </div>
</nav>

    <main>
         
        <div class="container">
            <section class="hero-section">
                <div class="hero-content">
                    <h1>Shop with us</h1>
                    <p>Discover amazing products at discounted prices</p>
                    <button class="cta-button">Shop Now</button>
                </div>
            </section>
        
            <section class="categories-section">
                <h2 class="section-title">Shop by Category</h2>
                <div class="categories-grid">
                    <div class="category-card" onclick="filterByCategory('Electronics')">
                        <div class="category-icon"></div>
                        <div class="category-name">Electronics</div>
                    </div>
                   <div class="category-card" onclick="filterByCategory('Fashion')">
                    <div class="category-icon"></div>
                   <div class="category-name">Fashion</div>
                    </div>

                    <div class="category-card" onclick="filterByCategory('Home')">
                    <div class="category-icon"></div>
                     <div class="category-name">Home</div>
                    </div>
                   <div class="category-card" onclick="filterByCategory('Books')">
                    <div class="category-icon"></div>
                    <div class="category-name">Books</div>
                    </div>
                    <div class="category-card" onclick="filterByCategory('Sports')">
                        <div class="category-icon"></div>
                        <div class="category-name">Sports</div>
                    </div>
                
                    <div class="category-card" onclick="filterByCategory('Gaming')">
                        <div class="category-icon"></div>
                        <div class="category-name">Gaming</div>
                    </div>
                </div>
            </section>what 

            <section class="products-section">
                <h2 class="section-title">Featured Products</h2>
                <div class="products-grid" id="productsGrid">
                    
                </div>
            </section>
        </div>
    </main>
<div class="cart-dropdown" id="cartDropdown">
        <div class="cart-header">
            <h3>Shopping Cart</h3>
            <button class="close-cart" onclick="closeCart()">×</button>
        </div>
        <div class="cart-items" id="cartItems">
            <div class="empty-cart">
                <p>Your cart is empty</p>
                <span style="font-size: 48px;"></span>
            </div>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <strong>Total: KSh <span id="cartTotal">0</span></strong>
            </div>
            <div class="cart-actions">
                <button class="clear-cart-btn" onclick="clearCart()">Clear Cart</button>
               <button class="checkout-btn" onclick="proceedToCheckout()">Checkout</button>

                <button class="intaSendPayButton" data-amount="10" data-currency="KES">Pay now</button>
            </div>
        </div>
    </div>

    
    <div class="cart-overlay" id="cartOverlay" onclick="closeCart()"></div>

    
    <div class="cart-success" id="cartSuccess">
            Item added to cart successfully!
    </div>

    </div>
</div>

<!-- Modal Overlay -->
<div class="product-modal-overlay" id="productModalOverlay" onclick="closeProductModal()"></div>
    <script>

let allProducts = [];
let currentCategory = 'all';
let cartCount = 0;
let cartItems = [];

// Load products from database on page load
document.addEventListener('DOMContentLoaded', function() {
    loadProductsFromDatabase();
    updateCartDisplay();
    handlePaymentReturn();
    console.log('System initialized');
});

// Load products from backend database
async function loadProductsFromDatabase() {
    try {
        console.log('Loading products from database...');
        
        const response = await fetch('http://localhost:8080/api/products');
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const result = await response.json();
        
        if (result.success && result.data) {
            displayProducts(result.data);
            console.log(`Loaded ${result.data.length} products from database`);
        } else {
            console.error('No products returned from backend');
            showErrorMessage('Failed to load products');
        }
        
    } catch (error) {
        console.error('Error loading products:', error);
        showErrorMessage('Unable to connect to server. Please refresh the page.');
    }
}

//  Display products dynamically
function displayProducts(products) {
    const productsGrid = document.querySelector('.products-grid');
    
    if (!products || products.length === 0) {
        productsGrid.innerHTML = '<p class="no-products">No products available</p>';
        return;
    }
    
    productsGrid.innerHTML = products.map(product => `
        <div class="product-card" data-category="${product.category}" data-product-id="${product.id}">
            <div class="product-image">
                ${product.imageUrl 
                    ? `<img src="${product.imageUrl}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'">` 
                    : '<div class="placeholder">📦</div>'}
            </div>
            <div class="product-info">
                <div class="product-name">${product.name}</div>
                <div class="product-price">
                    KSh ${parseInt(product.price).toLocaleString()}
                    ${product.oldPrice ? `<span class="old-price">KSh ${parseInt(product.oldPrice).toLocaleString()}</span>` : ''}
                </div>
                
                <button class="add-to-cart" onclick="addToCart('${product.name}', ${product.price}, '${product.imageUrl || ''}')">
                    Add to Cart
                </button>
            </div>
        </div>
    `).join('');
    
    initializeProducts();
}

// Helper: Generate star ratings
function getStarRating(rating) {
    const fullStars = Math.floor(rating);
    const halfStar = rating % 1 >= 0.5 ? 1 : 0;
    const emptyStars = 5 - fullStars - halfStar;
    
    return '⭐'.repeat(fullStars) + 
           (halfStar ? '✨' : '') + 
           '☆'.repeat(emptyStars);
}

// Helper: Show error message
function showErrorMessage(message) {
    const productsGrid = document.querySelector('.products-grid');
    productsGrid.innerHTML = `
        <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #ff4444;">
            <h3> ${message}</h3>
            <button onclick="loadProductsFromDatabase()" class="cta-button" style="margin-top: 20px;">
                Retry
            </button>
        </div>
    `;
}

//  Initialize products array from DOM
function initializeProducts() {
    const productCards = document.querySelectorAll('.product-card');
    allProducts = Array.from(productCards).map(card => {
        return {
            element: card,
            name: card.querySelector('.product-name').textContent,
            category: card.getAttribute('data-category'),
            id: card.getAttribute('data-product-id')
        };
    });
    console.log(`Initialized ${allProducts.length} products for filtering`);
}

//  Get product ID from DOM
function getProductIdByName(productName) {
    const productCard = Array.from(document.querySelectorAll('.product-card'))
        .find(card => card.querySelector('.product-name').textContent === productName);
    
    if (productCard) {
        return parseInt(productCard.getAttribute('data-product-id'));
    }
    
    console.warn(`Product ID not found for: ${productName}`);
    return 1;
}

// Category filtering (existing function - no changes needed)
function filterByCategory(category) {
    currentCategory = category;
    
    document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
    });
    event.target.classList.add('active');
    
    let visibleCount = 0;
    allProducts.forEach(product => {
        if (product.category === category) {
            product.element.style.display = 'block';
            product.element.classList.remove('hidden');
            visibleCount++;
        } else {
            product.element.style.display = 'none';
            product.element.classList.add('hidden');
        }
    });
    
    const sectionTitle = document.querySelector('.products-section .section-title');
    sectionTitle.textContent = `${category} Products`;
    
    showNoProductsMessage(visibleCount, category);
}

function showAllProducts() {
    currentCategory = 'all';
    
    document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
    });
    event.target.classList.add('active');
    
    allProducts.forEach(product => {
        product.element.style.display = 'block';
        product.element.classList.remove('hidden');
    });
    
    const sectionTitle = document.querySelector('.products-section .section-title');
    sectionTitle.textContent = 'Featured Products';
    
    removeNoProductsMessage();
}

function showNoProductsMessage(count, category) {
    removeNoProductsMessage();
    if (count === 0) {
        const productsGrid = document.querySelector('.products-grid');
        const noProductsDiv = document.createElement('div');
        noProductsDiv.className = 'no-products';
        noProductsDiv.innerHTML = `
            <p>No products found in ${category} category.</p>
            <button onclick="showAllProducts()" class="cta-button">View All Products</button>
        `;
        productsGrid.appendChild(noProductsDiv);
    }
}

function removeNoProductsMessage() {
    const existingMessage = document.querySelector('.no-products');
    if (existingMessage) {
        existingMessage.remove();
    }
}

function searchProducts(searchTerm) {
    if (!searchTerm) {
        showAllProducts();
        return;
    }
    
    let visibleCount = 0;
    allProducts.forEach(product => {
        const matchesSearch = product.name.toLowerCase().includes(searchTerm.toLowerCase());
        const matchesCategory = currentCategory === 'all' || product.category === currentCategory;
        
        if (matchesSearch && matchesCategory) {
            product.element.style.display = 'block';
            product.element.classList.remove('hidden');
            visibleCount++;
        } else {
            product.element.style.display = 'none';
            product.element.classList.add('hidden');
        }
    });
    
    const sectionTitle = document.querySelector('.products-section .section-title');
    sectionTitle.textContent = `Search Results for "${searchTerm}"`;
    
    showNoProductsMessage(visibleCount, `search "${searchTerm}"`);
}

function handleSearch(event) {
    if (event.key === 'Enter') {
        performSearch();
    }
}

function performSearch() {
    const searchTerm = document.getElementById('searchInput').value;
    searchProducts(searchTerm);
}


   
  //cart display
        function updateCartDisplay() {
            try {
                const cartBadge = document.getElementById('cartBadge');
                
                if (!cartBadge) {
                    console.error('Cart badge element not found');
                    return;
                }
                
                // Update the number
                cartBadge.textContent = cartCount;
                
                
                if (cartCount > 0) {
                    cartBadge.classList.add('show');
                    
                    cartBadge.classList.add('animate');
                    
                
                    setTimeout(() => {
                        cartBadge.classList.remove('animate');
                    }, 600);
                } else {
                    cartBadge.classList.remove('show');
                }
                
                //  cart badge for numbers 
                if (cartCount > 99) {
                    cartBadge.textContent = '99+';
                }
                
                console.log('Cart display updated:', cartCount);
                
            } catch (error) {
                console.error('Error updating cart display:', error);
            }
        }

        function showCartSuccess(productName) {
            try {
                const successMsg = document.getElementById('cartSuccess');
                
                if (!successMsg) {
                    console.error('Success message element not found');
                    return;
                }
                
                successMsg.innerHTML = ` ${productName} added to cart!`;
                successMsg.classList.add('show');
                
                setTimeout(() => {
                    successMsg.classList.remove('show');
                }, 3000);
                
            } catch (error) {
                console.error('Error showing success message:', error);
            }
        }
        // cart slider
async function toggleCart(event) {
    event.preventDefault();
    
    const cartDropdown = document.getElementById('cartDropdown');
    const cartOverlay = document.getElementById('cartOverlay');
    
    
    if (!cartDropdown.classList.contains('open')) {
        console.log('Opening cart, loading data...');
        await loadCartFromBackend();
        updateCartView();
    }
    
    cartDropdown.classList.toggle('open');
    cartOverlay.classList.toggle('open');
    
    if (cartDropdown.classList.contains('open')) {
        document.body.style.overflow = 'hidden';
    } else {
        document.body.style.overflow = 'auto';
    }
}

function closeCart() {
    const cartDropdown = document.getElementById('cartDropdown');
    const cartOverlay = document.getElementById('cartOverlay');
    
    cartDropdown.classList.remove('open');
    cartOverlay.classList.remove('open');
    document.body.style.overflow = 'auto';
}

function updateCartView() {
    const cartItemsContainer = document.getElementById('cartItems');
    const cartTotalElement = document.getElementById('cartTotal');
    
    console.log('updateCartView called with items:', cartItems);
    
    if (!cartItems || cartItems.length === 0) {
        cartItemsContainer.innerHTML = `
            <div class="empty-cart">
                <p>Your cart is empty</p>
                <span style="font-size: 48px;">🛒</span>
            </div>
        `;
        cartTotalElement.textContent = '0';
        return;
    }
    
    const cartHTML = cartItems.map(item => `
        <div class="cart-item">
            <div class="cart-item-image">
                ${item.image ? `<img src="${item.image}" alt="${item.name}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;">` : getProductIcon(item.name)}
            </div>
            <div class="cart-item-details">
                <div class="cart-item-name">${item.name}</div>
                <div class="cart-item-price">KSh ${parseInt(item.price).toLocaleString()}</div>
                <div style="font-size: 12px; color: #666;">Qty: ${item.quantity}</div>
            </div>
            <div class="cart-item-actions">
                <button class="remove-item" onclick="removeCartItem(${item.id})">Remove</button>
            </div>
        </div>
    `).join('');
    
    cartItemsContainer.innerHTML = cartHTML;
    
    // Calculate total
    const total = cartItems.reduce((sum, item) => sum + (parseInt(item.price) * item.quantity), 0);
    cartTotalElement.textContent = total.toLocaleString();
    
    console.log('Cart view updated with HTML');
}

function getOrCreateSessionId() {
    let sessionId = localStorage.getItem('cart_session_id');
    if (!sessionId) {
        sessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('cart_session_id', sessionId);
    }
    return sessionId;
}
function handleSearch(event) {
    if (event.key === 'Enter') {
        performSearch();
    }
}

function performSearch() {
    const searchTerm = document.getElementById('searchInput').value;
    searchProducts(searchTerm);
}
function getProductIdByName(productName) {
    const productMap = {
        'iPhone 17 Pro Max': 1,
        'MacBook Pro 14': 2,
        'Sony WH-1000XM5': 3,
        'Apple Watch Series 9': 4,
        'Nike Air Max 270': 5,
        'Canon EOS R6': 6,
        'The Legend Book': 7
    };
    return productMap[productName] || 1;
}
// add to cart function backend
window.addToCart = async function(productName, price, imageUrl) {
    try {
        console.log('Adding to cart:', productName, price);
        
        const response = await fetch('http://localhost:8080/api/cart/add', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                productId: getProductIdByName(productName),
                quantity: 1,
                sessionId: getOrCreateSessionId()
            })
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const result = await response.json();
        
        if (result.success) {
            cartCount = result.data.totalItems;
            updateCartDisplay();
            showCartSuccess(productName);
            console.log('Added to cart successfully:', result.data);
        } else {
            console.error('Backend error:', result.message);
            alert('Error: ' + result.message);
        }
        
    } catch (error) {
        console.error('Error adding to cart:', error);
        alert('OUT OF STOCK. Please try later.');
    }
};



        // clear cart function 
       window.clearCart = async function() {
    if (confirm('Are you sure you want to clear your cart?')) {
        try {
            // Clear backend cart
            const sessionId = getOrCreateSessionId();
            const response = await fetch(`/api/cart/clear/${sessionId}`, {
                method: 'DELETE'
            });
            
            if (response.ok) {
                // Clear local cart
                cartCount = 0;
                cartItems = [];
                updateCartDisplay();
                updateCartView();
                console.log('Cart cleared successfully');
            } else {
                throw new Error('Backend clear failed');
            }
        } catch (error) {
            console.error('Error clearing cart:', error);
           
            cartCount = 0;
            cartItems = [];
            updateCartDisplay();
            updateCartView();
            alert('Cart cleared locally (backend unavailable)');
        }
    }
};

        window.removeFromCart = function(itemId) {
            cartItems = cartItems.filter(item => item.id !== itemId);
            cartCount = cartItems.length;
            updateCartDisplay();
            console.log('Item removed from cart');
        };

        window.getCartTotal = function() {
            return cartItems.reduce((total, item) => total + (item.price * item.quantity), 0);
        };

//intasend_config
const INTASEND_CONFIG = {
    publicKey: 'ISPubKey_test_f8ae9370-dee6-42f8-a090-f7e4fbf6c383', 
    baseURL: 'https://api.intasend.com/api/v1',
    successURL: window.location.origin + '/payment-success.html'

};
async function proceedToCheckout() {
    console.log('=STARTING CHECKOUT PROCESS =');
    
    if (cartItems.length === 0) {
        alert('Your cart is empty!');
        return;
    }
    
    try {
        console.log('About to collect customer info...');
        
        
        const customerInfo = await collectCustomerInfo();
        
        console.log('Customer info collected successfully:', customerInfo);
        
      
        const total = cartItems.reduce((sum, item) => sum + (parseInt(item.price) * item.quantity), 0);
        console.log('Total calculated:', total);
      
        const checkoutBtn = document.querySelector('.checkout-btn');
        const originalText = checkoutBtn.textContent;
        checkoutBtn.textContent = 'Processing...';
        checkoutBtn.disabled = true;
        
        console.log('=== CHECKOUT DEBUG ===');
        console.log('cartItems before mapping:', cartItems);

        const checkoutData = {
    ...customerInfo,
    amount: total,
    currency: "KES",
    api_ref: "order_" + Date.now(),
    redirect_url: window.location.origin + window.location.pathname + '?payment=success',  // Add query param
    comment: `Order for ${cartItems.length} items from Birgenshop`,
     
     items: cartItems.map(item => {
    const productId = item.productId || item.product?.id || item.id;
    console.log(`Mapping item: ${item.name}, productId found: ${productId}`);
    return {
        id: productId,
        name: item.name,
        price: item.price,
        quantity: item.quantity
    };
     })
};

        console.log('=== CHECKOUT DATA BEING SENT ===', checkoutData);
        console.log('Items array being sent:', checkoutData.items);
       console.log('Sending to backend:', checkoutData);

const response = await fetch('http://localhost:8080/api/orders/checkout', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(checkoutData)
});

console.log('Backend response status:', response.status);

const result = await response.json();
console.log('Backend response:', result);

if (result.success && result.data.url) {
    localStorage.setItem('pending_order', JSON.stringify({
        items: cartItems,
        total: total,
        checkout_id: result.data.id,
        api_ref: checkoutData.api_ref,
        customer: customerInfo
    }));
    
    console.log('Redirecting to:', result.data.url);
    window.location.href = result.data.url;
} else {
    throw new Error(result.message || 'Failed to create checkout session');
}
        
    } catch (error) {
        console.error('=CHECKOUT ERROR==');
        console.error('Error type:', typeof error);
        console.error('Error message:', error);
        console.error('Error string:', String(error));
        
        if (String(error) !== 'User cancelled') {
            alert('Failed to proceed to checkout. Please try again. Error: ' + error);
        } else {
            console.log('User cancelled the checkout process');
        }
        
       
        const checkoutBtn = document.querySelector('.checkout-btn');
        if (checkoutBtn) {
            checkoutBtn.textContent = 'Checkout';
            checkoutBtn.disabled = false;
        }
    }
}



function collectCustomerInfo() {
    return new Promise((resolve, reject) => {
        console.log('= OPENING CUSTOMER INFO MODAL =');
        
        const modalHTML = `
            <div class="customer-info-modal" style="
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 9999;
            ">
                <div style="
                    background: white;
                    padding: 30px;
                    border-radius: 12px;
                    max-width: 400px;
                    width: 90%;
                ">
                    <h3 style='margin-bottom: 20px; color: #333;'>Complete Your Order</h3>
                    <form id="customerInfoForm">
                        <div style="margin-bottom: 15px;">
                            <label style='display: block; margin-bottom: 5px; font-weight: 600;'>First Name *</label>
                            <input type="text" id="firstName" required style="
                                width: 100%;
                                padding: 12px;
                                border: 2px solid #ddd;
                                border-radius: 6px;
                                font-size: 14px;
                                box-sizing: border-box;
                            ">
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style='display: block; margin-bottom: 5px; font-weight: 600;'>Last Name *</label>
                            <input type="text" id="lastName" required style="
                                width: 100%;
                                padding: 12px;
                                border: 2px solid #ddd;
                                border-radius: 6px;
                                font-size: 14px;
                                box-sizing: border-box;
                            ">
                        </div>
                        <div style="margin-bottom: 15px;">
                            <label style='display: block; margin-bottom: 5px; font-weight: 600;'>Email *</label>
                            <input type="email" id="customerEmail" required style="
                                width: 100%;
                                padding: 12px;
                                border: 2px solid #ddd;
                                border-radius: 6px;
                                font-size: 14px;
                                box-sizing: border-box;
                            ">
                        </div>
                        <div style="margin-bottom: 20px;">
                            <label style='display: block; margin-bottom: 5px; font-weight: 600;'>Phone Number *</label>
                            <input type="tel" id="customerPhone" required placeholder="+254700000000" style="
                                width: 100%;
                                padding: 12px;
                                border: 2px solid #ddd;
                                border-radius: 6px;
                                font-size: 14px;
                                box-sizing: border-box;
                            ">
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button type="button" id="cancelCustomerInfo" style="
                                flex: 1;
                                background: #666;
                                color: white;
                                border: none;
                                padding: 12px;
                                border-radius: 6px;
                                cursor: pointer;
                                font-weight: 600;
                            ">Cancel</button>
                            <button type="submit" style="
                                flex: 1;
                                background: #ff6900;
                                color: white;
                                border: none;
                                padding: 12px;
                                border-radius: 6px;
                                cursor: pointer;
                                font-weight: 600;
                            ">Proceed to Payment</button>
                        </div>
                    </form>
                </div>
            </div>
        `;
        
        document.body.insertAdjacentHTML('beforeend', modalHTML);
        console.log('Modal HTML added to page');
        
        //for submision
        const form = document.getElementById('customerInfoForm');
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            console.log('==FORM SUBMITTED==');
            
            const customerInfo = {
                first_name: document.getElementById('firstName').value.trim(),
                last_name: document.getElementById('lastName').value.trim(),
                email: document.getElementById('customerEmail').value.trim(),
                phone_number: document.getElementById('customerPhone').value.trim()
            };
            
            console.log('Form data collected:', customerInfo);
            
           
            if (!customerInfo.first_name || !customerInfo.last_name || !customerInfo.email || !customerInfo.phone_number) {
                console.log('Validation failed: Missing required fields');
                alert('Please fill in all required fields');
                return;
            }
            
           
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(customerInfo.email)) {
                console.log('Validation failed: Invalid email');
                alert('Please enter a valid email address');
                return;
            }
            
            console.log('All validations passed, closing modal and resolving...');
            
           
            const modal = document.querySelector('.customer-info-modal');
            if (modal) {
                modal.remove();
                console.log('Modal removed');
            }
            
            resolve(customerInfo);
        });
        
        // cancel button
        document.getElementById('cancelCustomerInfo').addEventListener('click', function() {
            console.log('=USER CLICKED CANCEL=');
            const modal = document.querySelector('.customer-info-modal');
            if (modal) {
                modal.remove();
            }
            reject('User cancelled');
        });
        
        console.log('Event listeners attached');
    });
}

// for payment succes
async function handlePaymentReturn() {
    const urlParams = new URLSearchParams(window.location.search);
    const checkout_id = urlParams.get('checkout_id');
    const tracking_id = urlParams.get('tracking_id');
    
    if (checkout_id && tracking_id) {
        try {
            showPaymentVerification();
            
            // Get pending order from localStorage
            const pendingOrder = JSON.parse(localStorage.getItem('pending_order') || '{}');
            
            if (!pendingOrder.items || pendingOrder.items.length === 0) {
                throw new Error('No pending order found');
            }
            
            // Send order confirmation to backend
            const orderConfirmation = {
                intasendCheckoutId: checkout_id,
                intasendTrackingId: tracking_id,
                amount: pendingOrder.total,
                currency: 'KES',
                paymentStatus: 'COMPLETED',
                customerEmail: pendingOrder.customer.email,
                customerPhone: pendingOrder.customer.phone_number,
                apiRef: pendingOrder.api_ref,
                items: pendingOrder.items.map(item => ({
                    id: item.productId || item.id,
                  name: item.name,
                  price: item.price,
                  quantity: item.quantity
                    })),
                customerInfo: {
                    firstName: pendingOrder.customer.first_name,
                    lastName: pendingOrder.customer.last_name,
                    email: pendingOrder.customer.email,
                    phoneNumber: pendingOrder.customer.phone_number
                }
            };
            
            console.log('Sending order confirmation:', orderConfirmation);
            
            const response = await fetch('http://localhost:8080/api/orders/confirm', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(orderConfirmation)
            });
            
            const result = await response.json();
            console.log('Order confirmation response:', result);
            
            if (result.success) {
                // Clear cart after successful order
                await clearCart();
                localStorage.removeItem('pending_order');
                
                showPaymentSuccess({
                    id: checkout_id,
                    tracking_id: tracking_id,
                    amount: pendingOrder.total
                });
                
                // Clean URL
                window.history.replaceState({}, document.title, window.location.pathname);
            } else {
                throw new Error(result.message || 'Failed to confirm order');
            }
            
        } catch (error) {
            console.error('Payment confirmation error:', error);
            showPaymentError('Unable to confirm payment. Please contact support with your payment reference: ' + tracking_id);
        }
    }
}

function showPaymentVerification() {
    const modalHTML = `
        <div class="payment-verification-modal" style="
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        ">
            <div style="
                background: white;
                padding: 40px;
                border-radius: 12px;
                text-align: center;
                max-width: 400px;
            ">
                <div style="font-size: 48px; margin-bottom: 20px;">⏳</div>
                <h3>Verifying Payment...</h3>
                <p>Please wait while we confirm your payment.</p>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', modalHTML);
}

function showPaymentSuccess(paymentResult) {
    
    const verificationModal = document.querySelector('.payment-verification-modal');
    if (verificationModal) verificationModal.remove();
    
    const successHTML = `
        <div class="payment-success-modal" style="
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        ">
            <div style="
                background: white;
                padding: 40px;
                border-radius: 12px;
                text-align: center;
                max-width: 400px;
            ">
                <div style="font-size: 48px; color: #4CAF50; margin-bottom: 20px;">✓</div>
                <h2 style='color: #4CAF50; margin-bottom: 20px;'>Payment Successful!</h2>
                <p>Your order has been confirmed and will be processed shortly.</p>
                <p><strong>Transaction ID:</strong> ${paymentResult.id}</p>
                <p><strong>Amount:</strong> KSh ${parseInt(paymentResult.amount).toLocaleString()}</p>
                <button onclick="closeSuccessModal()" style="
                    background: #ff6900;
                    color: white;
                    border: none;
                    padding: 12px 24px;
                    border-radius: 6px;
                    margin-top: 20px;
                    cursor: pointer;
                    font-weight: 600;
                ">Continue Shopping</button>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', successHTML);
}

function showPaymentError(message) {
 
    const verificationModal = document.querySelector('.payment-verification-modal');
    if (verificationModal) verificationModal.remove();
    
    const errorHTML = `
        <div class="payment-error-modal" style="
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        ">
            <div style="
                background: white;
                padding: 40px;
                border-radius: 12px;
                text-align: center;
                max-width: 400px;
            ">
                <div style="font-size: 48px; color: #ff4444; margin-bottom: 20px;">✗</div>
                <h2 style='color: #ff4444; margin-bottom: 20px;'>Payment Error</h2>
                <p>${message}</p>
                <button onclick="closeErrorModal()" style="
                    background: #ff6900;
                    color: white;
                    border: none;
                    padding: 12px 24px;
                    border-radius: 6px;
                    margin-top: 20px;
                    cursor: pointer;
                    font-weight: 600;
                ">Try Again</button>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', errorHTML);
}

function closeSuccessModal() {
    const modal = document.querySelector('.payment-success-modal');
    if (modal) modal.remove();
   
    window.history.replaceState({}, document.title, window.location.pathname);
}

function closeErrorModal() {
    const modal = document.querySelector('.payment-error-modal');
    if (modal) modal.remove();
   
    window.history.replaceState({}, document.title, window.location.pathname);
}

function restorePendingOrder() {
    const pendingOrder = JSON.parse(localStorage.getItem('pending_order') || '{}');
    if (pendingOrder.items) {
        cartItems = pendingOrder.items;
        cartCount = cartItems.reduce((sum, item) => sum + item.quantity, 0);
        updateCartDisplay();
        updateCartView();
    }
}

async function sendOrderConfirmation(paymentResult, orderDetails) {
    try {
        const orderData = {
            intasend_checkout_id: paymentResult.id,
            intasend_tracking_id: paymentResult.tracking_id,
            amount: paymentResult.amount,
            currency: paymentResult.currency,
            items: orderDetails.items,
            payment_status: 'COMPLETED',
            customer_email: paymentResult.email,
            customer_phone: paymentResult.phone_number,
            api_ref: paymentResult.api_ref,
            customer_info: orderDetails.customer
        };
        
        const response = await fetch('http://localhost:8080/api/orders/confirm', { 
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(orderData)
        });
        
        if (!response.ok) {
            console.error('Failed to save order to backend');
        } else {
            console.log('Order confirmation sent to backend');
        }
        
    } catch (error) {
        console.error('Error sending order confirmation:', error);
    }
}


document.addEventListener('DOMContentLoaded', function() {
   //check for payment
    handlePaymentReturn();
});


async function loadCartFromBackend() {
    try {
        const sessionId = getOrCreateSessionId();
        
        console.log('Loading cart for session:', sessionId);
        
        const response = await fetch(`http://localhost:8080/api/cart/${sessionId}`);
        console.log('Cart API response status:', response.status);
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        8
        const result = await response.json();
        console.log('Cart API response:', result);
        
        if (result.success && result.data) {
            
            cartItems = [];
            
            
            if (result.data.cartItems && result.data.cartItems.length > 0) {
                cartItems = result.data.cartItems.map(item => {
                    return {
                        id: item.id,
                        productId: item.product?.id || item.productID || 7,
                        name: item.product.name,
                        price: item.product.price,
                        quantity: item.quantity,
                        image: item.product.imageUrl || '',
                        subtotal: item.subtotal || (item.product.price * item.quantity)
                    };
                });
            }
            
            cartCount = result.data.totalItems || 0;
            
            console.log('Processed cart items:', cartItems);
            console.log('Cart count:', cartCount);
            
            return true;
        } else {
            console.error('Backend error or no data:', result);
            return false;
        }
    } catch (error) {
        console.error('Error loading cart from backend:', error);
       
        return false;
    }
}

async function processPayment(orderId, amount) {
    try {
        const paymentData = {
            orderId: orderId,
            paymentMethod: "CREDIT_CARD", 
           
        };
        
        console.log('Processing payment:', paymentData);
        
        const response = await fetch('http://localhost:8080/api/checkout/payment', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(paymentData)
        });
        
        if (!response.ok) {
            throw new Error(`Payment failed: ${response.status}`);
        }
        
        const result = await response.json();
        
        if (result.success) {
            alert('Payment successful! Order confirmed.');
            await clearCart(); // Clear cart after successful payment
            closeCart();
        } else {
            alert('Payment failed: ' + result.message);
        }
        
    } catch (error) {
        console.error('Payment error:', error);
        alert('Payment failed. Please try again.');
    }
}
   async function removeCartItem(cartItemId) {
    try {
        const sessionId = getOrCreateSessionId();
        const response = await fetch(`/api/cart/item/${cartItemId}?sessionId=${sessionId}`, {
            method: 'DELETE'
        });
        
        const result = await response.json();
        
        if (result.success) {
            
            await loadCartFromBackend();
            updateCartView();
            updateCartDisplay();
            console.log('Item removed successfully');
        } else {
            console.error('Failed to remove item:', result.message);
        }
    } catch (error) {
        console.error('Error removing cart item:', error);
    }
}

function subscribeNewsletter() {
    const emailInput = document.getElementById('newsletterEmail');
    const successMessage = document.getElementById('newsletterSuccess');
    const email = emailInput.value.trim();

   
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    
    if (!email) {
        alert('Please enter your email address');
        return;
    }
    
    if (!emailRegex.test(email)) {
        alert('Please enter a valid email address');
        return;
    }

   
    successMessage.classList.add('show');
    emailInput.value = '';
    
    // Hide success message after 5 seconds
    setTimeout(() => {
        successMessage.classList.remove('show');
    }, 1000);

    console.log('Newsletter subscription:', email);
    
}


document.addEventListener('DOMContentLoaded', function() {
    const emailInput = document.getElementById('newsletterEmail');
    if (emailInput) {
        emailInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                subscribeNewsletter();
            }
        });
    }
});

    </script>
<!-- Footer -->
<footer class="footer" style="background: linear-gradient(135deg, #a8b0ad, #828786); color: white; padding: 80px 20px 40px; margin-top: 50px;">
    <div class="footer-content" style="max-width: 1200px; margin: 0 auto;">
        <div class="footer-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 40px; margin-bottom: 50px;">
             <!--Shop function-->
            <div class="footer-section">
                <h3>Shop</h3>
                <ul class="footer-links">
                    <li><a href="#electronics">Electronics</a></li>
                    <li><a href="#fashion">Fashion</a></li>
                    <li><a href="#home">Home & Garden</a></li>
                    <li><a href="#sports">Sports</a></li>
                    <li><a href="#gaming">Gaming</a></li>
                    <li><a href="#books">Books</a></li>
                    
                </ul>
            </div>

            <!-- Help Section -->
            <div class="footer-section">
                <h3>Help</h3>
                <ul class="footer-links">
                    <li><a href="#contact">Contact Us</a></li>
                    <li><a href="#faq">FAQ</a></li>
                    <li><a href="#shipping">Shipping Info</a></li>
                    <li><a href="#returns">Returns</a></li>
                    <li><a href="#support">Customer Support</a></li>
                    
                </ul>
            </div>

            <!-- About Section -->
            <div class="footer-section">
                <h3>About</h3>
                <ul class="footer-links">
                    <li><a href="#story">Our Story</a></li>
                    <li><a href="#careers">Careers</a></li>
                    <li><a href="#wholesale">Wholesale</a></li>
                    
                </ul>
            </div>
             
            <!-- Newsletter Section -->
            <div class="footer-section newsletter-section">
                <h3>Sign up to get 10% off your first order</h3>
                <p class="newsletter-description">
                    Subscribe to our newsletter and be the first to know about new products and exclusive deals.
                </p>
                <div class="newsletter-form">
                    <input 
                        type="email" 
                        class="newsletter-input" 
                        placeholder="Your Email Address"
                        id="newsletterEmail"
                        required
                    >
                    <button class="newsletter-btn" onclick="subscribeNewsletter()">
                        Subscribe
                    </button>
                </div>
                <div class="newsletter-success" id="newsletterSuccess">
                    Thank you for subscribing! 
                </div>

                <!-- Social Media Links -->
                <div class="social-links">
                    <a href="#" class="social-link" title="Follow us on Instagram"></a>
                    <a href="#" class="social-link" title="Follow us on Facebook"></a>
                    <a href="#" class="social-link" title="Follow us on Twitter"></a>
                    <a href="#" class="social-link" title="Connect on LinkedIn"></a>
                </div>
            </div>
        </div>

        <!-- Footer Bottom -->
        <div class="footer-bottom">
            <div class="copyright">
                © 2025 Birgenshop, Inc. All Rights Reserved
            </div>
            <div class="footer-bottom-links">
                <a href="#terms">Terms of Service</a>
                <a href="#privacy">Privacy Policy</a>
                <a href="#cookies">Cookie Policy</a>
               
            </div>
        </div>
    </div>
</footer>

</body>
</html>
     